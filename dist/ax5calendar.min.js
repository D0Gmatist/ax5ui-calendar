!function(e,t){var a=ax5.util,n=function(){t&&t.call(this);var e,n=this,i=1;this.target=null,this.selection=[],this.selectableMap={},this.printedDay={start:"",end:""},this.config={clickEventName:"click",theme:"default",mode:"day",dateFormat:"yyyy-mm-dd",displayDate:new Date,animateTime:250,dimensions:{controlHeight:"40px",controlButtonWidth:"40px",itemPadding:2},lang:{yearHeading:"Choose the year",monthHeading:"Choose the month",yearTmpl:"%s",months:["January","February","March","April","May","June","July","August","September","October","November","December"],dayTmpl:"%s"},multipleSelect:!1,selectMode:"day"},e=this.config,this.init=function(){e.target||console.log(ax5.info.getError("ax5calendar","401","setConfig")),this.target=jQuery(e.target),e.displayDate=a.date(e.displayDate),this.target.html(this.getFrame()),this.$={root:this.target.find('[data-calendar-els="root"]'),control:this.target.find('[data-calendar-els="control"]'),"control-display":this.target.find('[data-calendar-els="control-display"]'),body:this.target.find('[data-calendar-els="body"]')},e.control&&this.$.control.find("[data-calendar-move]").on(e.clickEventName,function(e){this.move(e||window.event)}.bind(this)),e.selectable&&(this.selectableMap={},a.isArray(e.selectable)?e.selectable.forEach(function(e){n.selectableMap[e]=!0}):a.isObject(e.selectable)&&(e.selectable.from||e.selectable.to)&&e.selectable.from&&e.selectable.to),"day"===e.mode||"d"===e.mode?this.printDay(e.displayDate):"month"===e.mode||"m"===e.mode?this.printMonth(e.displayDate):("year"===e.mode||"y"===e.mode)&&this.printYear(e.displayDate)},this.getFrame=function(){var t=[];if(t.push('<div class="ax5-ui-calendar '+e.theme+'" data-calendar-els="root" onselectstart="return false;">'),e.control){var n={},i={};i.height=n.height=a.cssNumber(e.dimensions.controlHeight),i["line-height"]=n["line-height"]=a.cssNumber(e.dimensions.controlHeight),i.width=a.cssNumber(e.dimensions.controlHeight),t.push('<div class="calendar-control" data-calendar-els="control" style="'+a.css(n)+'">'),t.push('<a class="date-move-left" data-calendar-move="left" style="'+a.css(i)+'">'+e.control.left+"</a>"),t.push('<div class="date-display" data-calendar-els="control-display" style="'+a.css(n)+'"></div>'),t.push('<a class="date-move-right" data-calendar-move="right" style="'+a.css(i)+'">'+e.control.right+"</a>"),t.push("</div>")}return t.push('<div class="calendar-body" data-calendar-els="body"></div>'),t.push("</div>"),t.join("")},this.setDisplay=function(){if(e.control){var t=a.date(e.displayDate),n="",i="";if("day"==e.mode||"d"==e.mode)n=e.control.yearTmpl?e.control.yearTmpl.replace("%s",t.getFullYear()):t.getFullYear(),i=e.control.monthTmpl?e.control.monthTmpl.replace("%s",e.lang.months[t.getMonth()]):e.lang.months[t.getMonth()],this.$["control-display"].html(function(){return e.control.yearFirst?'<span data-calendar-display="year">'+n+'</span><span data-calendar-display="month">'+i+"</span>":'<span data-calendar-display="month">'+i+'</span><span data-calendar-display="year">'+n+"</span>"}());else if("month"==e.mode||"m"==e.mode)n=e.control.yearTmpl?e.control.yearTmpl.replace("%s",t.getFullYear()):t.getFullYear(),this.$["control-display"].html('<span data-calendar-display="year">'+n+"</span>");else if("year"==e.mode||"y"==e.mode){var s=e.control.yearTmpl?e.control.yearTmpl.replace("%s",t.getFullYear()-10):t.getFullYear()-10,l=e.control.yearTmpl?e.control.yearTmpl.replace("%s",Number(t.getFullYear())+9):Number(t.getFullYear())+9;this.$["control-display"].html(s+" ~ "+l)}this.$["control-display"].find("[data-calendar-display]").on(e.clickEventName,function(e){if(target=a.findParentNode(e.target,function(e){return e.getAttribute("data-calendar-display")?!0:void 0}),target){var t=target.getAttribute("data-calendar-display");this.changeMode(t)}}.bind(this))}return this},this.printDay=function(t){var i,s,l,d=a.date(t),r=[],o=new Date(d.getFullYear(),d.getMonth(),1,12),c=e.displayDate,h=function(){var e=o.getDay();return 0==e&&(e=7),a.date(o,{add:{d:-e}})}(),p=d.getMonth(),u=(d.getDate(),{}),m=this.$.body.width(),y=Math.floor(m*(6/7));for(e.dimensions.height&&(y=a.number(e.dimensions.height)),u.height=Math.floor(y/6)-2*a.number(e.dimensions.itemPadding)+"px",u["line-height"]=u.height,u.padding=a.cssNumber(e.dimensions.itemPadding),r.push('<table data-calendar-table="day" cellpadding="0" cellspacing="0" style="width:100%;">'),r.push("<thead>"),r.push("<tr>"),l=0;7>l;)r.push('<td class="calendar-col-'+l+'">'),r.push(ax5.info.weekNames[l].label),r.push("</td>"),l++;for(r.push("</tr>"),r.push("</thead>"),r.push("<tbody>"),i=h,s=0;6>s;){for(r.push("<tr>"),l=0;7>l;)r.push('<td class="calendar-col-'+l+'" style="'+a.css(u)+'">'),r.push('<a class="calendar-item-day '+function(){return e.selectable?n.selectableMap[a.date(i,{"return":e.dateFormat})]?i.getMonth()==p?"live":"":"disable":i.getMonth()==p?a.date(i,{"return":"yyyymmdd"})==a.date(c,{"return":"yyyymmdd"})?"focus":"live":""}()+" "+function(){return""}()+'" data-calendar-item-date="'+a.date(i,{"return":e.dateFormat})+'"><span class="addon"></span>'+e.lang.dayTmpl.replace("%s",i.getDate())+'<span class="lunar"></span></a>'),r.push("</td>"),l++,i=a.date(i,{add:{d:1}});r.push("</tr>"),s++}if(r.push("</tbody>"),r.push("</table>"),this.$.body.html(r.join("")),this.$.body.find("[data-calendar-item-date]").on(e.clickEventName,function(e){e=e||window.event,n.onclick(e,"date");try{e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0}catch(e){}return!1}),this.printedDay={start:h,end:i},e.onStateChanged){var g={action:"printDay",printedDay:this.printedDay};e.onStateChanged.call(g,g)}this.setDisplay()},this.printMonth=function(t){var i,s,l,d,r=a.date(t),o=r.getMonth(),c=[],h={},p=this.$.body.width(),u=Math.floor(p*(6/7));for(e.dimensions.height&&(u=a.number(e.dimensions.height)),h.height=Math.floor(u/4)-2*a.number(e.dimensions.itemPadding)+"px",h["line-height"]=h.height,h.padding=a.cssNumber(e.dimensions.itemPadding),c.push('<table data-calendar-table="month" cellpadding="0" cellspacing="0" style="width:100%;">'),c.push("<thead>"),c.push("<tr>"),c.push('<td class="calendar-col-0" colspan="3">'+e.lang.monthHeading+"</td>"),c.push("</tr>"),c.push("</thead>"),c.push("<tbody>"),d=0,l=0,i=0;4>i;){for(c.push("<tr>"),s=0;3>s;)c.push('<td class="calendar-col-'+i+'" style="'+a.css(h)+'">'),c.push('<a class="calendar-item-month '+function(){return e.selectable?n.selectableMap[l]?"live":"disable":"live"}()+" "+function(){return l==o?"focus":""}()+'" data-calendar-item-month="'+function(){return r.getFullYear()+"-"+a.setDigit(l+1,2)+"-"+a.setDigit(r.getDate(),2)}()+'">'+e.lang.months[l]+"</a>"),c.push("</td>"),l++,s++;c.push("</tr>"),i++}if(c.push("</tbody>"),c.push("</table>"),this.$.body.html(c.join("")),this.$.body.find("[data-calendar-item-month]").on(e.clickEventName,function(e){e=e||window.event,n.onclick(e,"month");try{e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0}catch(e){}return!1}),this.printedDay={start:r.getFullYear()+"-"+a.setDigit(d+1,2),end:r.getFullYear()+"-"+a.setDigit(l,2)},e.onStateChanged){var m={action:"printMonth",printedDay:this.printedDay};e.onStateChanged.call(m,m)}return this.setDisplay(),this},this.printYear=function(t){var i,s,l,d,r=a.date(t),o=r.getFullYear(),c=[],h={},p=this.$.body.width(),u=Math.floor(p*(6/7));for(e.dimensions.height&&(u=a.number(e.dimensions.height)),h.height=Math.floor(u/5)-2*a.number(e.dimensions.itemPadding)+"px",h["line-height"]=h.height,h.padding=a.cssNumber(e.dimensions.itemPadding),c.push('<table data-calendar-table="year" cellpadding="0" cellspacing="0" style="width:100%;">'),c.push("<thead>"),c.push("<tr>"),c.push('<td class="calendar-col-0" colspan="4">'+e.lang.yearHeading+"</td>"),c.push("</tr>"),c.push("</thead>"),c.push("<tbody>"),d=o-10,l=o-10,i=0;5>i;){for(c.push("<tr>"),s=0;4>s;)c.push('<td class="calendar-col-'+i+'" style="'+a.css(h)+'">'),c.push('<a class="calendar-item-year '+function(){return e.selectable?n.selectableMap[l]?"live":"disable":"live"}()+" "+function(){return l==o?"focus":""}()+'" data-calendar-item-year="'+function(){return l+"-"+a.setDigit(r.getMonth()+1,2)+"-"+a.setDigit(r.getDate(),2)}()+'">'+e.lang.yearTmpl.replace("%s",l)+"</a>"),c.push("</td>"),l++,s++;c.push("</tr>"),i++}if(c.push("</tbody>"),c.push("</table>"),this.$.body.html(c.join("")),this.$.body.find("[data-calendar-item-year]").on(e.clickEventName,function(e){e=e||window.event,n.onclick(e,"year");try{e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0}catch(e){}return!1}),this.printedDay={start:d,end:l-1},e.onStateChanged){var m={action:"printYear",printedDay:this.printedDay};e.onStateChanged.call(m,m)}return this.setDisplay(),this},this.onclick=function(t,s,l,d){if(s=s||"date",l=a.findParentNode(t.target,function(e){return e.getAttribute("data-calendar-item-"+s)?!0:void 0})){d=l.getAttribute("data-calendar-item-"+s);var r=a.date(d,{"return":e.dateFormat}),o=!0;if(i=e.multipleSelect?a.isNumber(e.multipleSelect)?e.multipleSelect:2:1,e.selectable&&(n.selectableMap[r]||(o=!1)),"date"==s){if(o){if(n.selection.length>=i){var c=n.selection.splice(0,n.selection.length-(i-1));c.forEach(function(t){n.$.body.find('[data-calendar-item-date="'+a.date(t,{"return":e.dateFormat})+'"]').removeClass("selected-day")})}jQuery(l).addClass("selected-day"),n.selection.push(d),e.onClick&&e.onClick.call({date:d,target:this.target,dateElement:l})}}else if("month"==s)if("month"==e.selectMode){if(o){if(n.selection.length>=i){var c=n.selection.splice(0,n.selection.length-(i-1));c.forEach(function(e){n.$.body.find('[data-calendar-item-month="'+a.date(e,{"return":"yyyy-mm-dd"})+'"]').removeClass("selected-month")})}jQuery(l).addClass("selected-month"),n.selection.push(d),e.onClick&&e.onClick.call({date:d,target:this.target,dateElement:l})}}else n.changeMode("day",d);else if("year"==s)if("year"==e.selectMode){if(o){if(n.selection.length>=i){var c=n.selection.splice(0,n.selection.length-(i-1));c.forEach(function(e){n.$.body.find('[data-calendar-item-year="'+a.date(e,{"return":"yyyy-mm-dd"})+'"]').removeClass("selected-year")})}jQuery(l).addClass("selected-year"),n.selection.push(d),e.onClick&&e.onClick.call({date:d,target:this.target,dateElement:l})}}else n.changeMode("month",d)}},this.move=function(t,n,i){return n=a.findParentNode(t.target,function(e){return e.getAttribute("data-calendar-move")?!0:void 0}),n&&(i=n.getAttribute("data-calendar-move"),"day"==e.mode?("left"==i?e.displayDate=a.date(e.displayDate,{add:{m:-1}}):e.displayDate=a.date(e.displayDate,{add:{m:1}}),this.printDay(e.displayDate)):"month"==e.mode?("left"==i?e.displayDate=a.date(e.displayDate,{add:{y:-1}}):e.displayDate=a.date(e.displayDate,{add:{y:1}}),this.printMonth(e.displayDate)):"year"==e.mode&&("left"==i?e.displayDate=a.date(e.displayDate,{add:{y:-10}}):e.displayDate=a.date(e.displayDate,{add:{y:10}}),this.printYear(e.displayDate))),this},this.changeMode=function(t,a){return"undefined"!=typeof a&&(e.displayDate=a),t&&(e.mode=t),this.$.body.removeClass("fadein").addClass("fadeout"),setTimeout(function(){"day"==e.mode||"d"==e.mode?this.printDay(e.displayDate):"month"==e.mode||"m"==e.mode?this.printMonth(e.displayDate):("year"==e.mode||"y"==e.mode)&&this.printYear(e.displayDate),this.$.body.removeClass("fadeout").addClass("fadein")}.bind(this),e.animateTime),this},this.setDisplayDate=function(t){return e.displayDate=a.date(t),this.$.body.removeClass("fadein").addClass("fadeout"),setTimeout(function(){"day"==e.mode||"d"==e.mode?this.printDay(e.displayDate):"month"==e.mode||"m"==e.mode?this.printMonth(e.displayDate):("year"==e.mode||"y"==e.mode)&&this.printYear(e.displayDate),this.$.body.removeClass("fadeout").addClass("fadein")}.bind(this),e.animateTime),this},this.setSelection=function(t){return a.isArray(t)?(i=e.multipleSelect?a.isNumber(e.multipleSelect)?e.multipleSelect:2:1,this.selection=t.splice(0,i),this.selection.forEach(function(t){n.$.body.find('[data-calendar-item-date="'+a.date(t,{"return":e.dateFormat})+'"]').addClass("selected-day")}),this):this},this.getSelection=function(){return this.selection},this.main=function(){arguments&&a.isObject(arguments[0])&&this.setConfig(arguments[0])}.apply(this,arguments)};a.isFunction(t)&&(n.prototype=new t),e.calendar=n}(ax5.ui,ax5.ui.root);